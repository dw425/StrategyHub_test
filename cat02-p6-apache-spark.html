<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Spark | Data Engineering | Strategy Hub</title>
    <style>
        :root {
            --brand-orange: #FF9900;
            --cat-primary: #06B6D4;
            --cat-light: #22D3EE;
            --cat-dark: #0891B2;
            --cat-glow: rgba(6, 182, 212, 0.15);
            --page-primary: #E25A1C;
            --page-light: #FF7A45;
            --page-glow: rgba(226, 90, 28, 0.15);
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-card-alt: #1a1a2e;
            --bg-hover: #252538;
            --border-color: #2a2a3e;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --text-muted: #6a6a7a;
            --green: #10B981;
            --yellow: #F59E0B;
            --red: #EF4444;
            --blue: #3B82F6;
            --cyan: #06B6D4;
            --pink: #EC4899;
            --violet: #8B5CF6;
            --sidebar-width: 260px;
            --header-height: 60px;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-dark); color: var(--text-primary); line-height: 1.6; }
        
        header { background: var(--bg-card); border-bottom: 1px solid var(--border-color); padding: 16px 32px; position: fixed; top: 0; left: 0; right: 0; z-index: 1000; height: var(--header-height); display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 20px; font-weight: 700; }
        .logo span { color: var(--brand-orange); }
        .breadcrumb { display: flex; align-items: center; gap: 8px; font-size: 13px; }
        .breadcrumb a { color: var(--text-secondary); text-decoration: none; }
        .breadcrumb a:hover { color: var(--brand-orange); }
        .breadcrumb .sep { color: var(--text-muted); }
        .breadcrumb .current { color: var(--text-primary); }
        
        .sidebar { position: fixed; top: var(--header-height); left: 0; width: var(--sidebar-width); height: calc(100vh - var(--header-height)); background: var(--bg-card); border-right: 1px solid var(--border-color); overflow-y: auto; z-index: 100; padding: 24px 0; }
        .sidebar-section { margin-bottom: 24px; }
        .sidebar-title { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--page-light); padding: 0 24px; margin-bottom: 8px; }
        .sidebar-nav { list-style: none; }
        .sidebar-nav a { display: flex; align-items: center; gap: 8px; padding: 10px 24px; color: var(--text-secondary); text-decoration: none; font-size: 12px; border-left: 3px solid transparent; transition: all 0.2s; }
        .sidebar-nav a:hover { background: var(--bg-hover); color: var(--text-primary); }
        .sidebar-nav a.active { background: var(--page-glow); color: var(--page-light); border-left-color: var(--page-light); }
        .nav-icon { font-size: 14px; width: 24px; text-align: center; }
        
        .main-wrapper { margin-left: var(--sidebar-width); margin-top: var(--header-height); }
        .main-content { max-width: 1100px; padding: 32px; }
        
        .hero-compact { display: grid; grid-template-columns: 1fr 1fr; gap: 32px; margin-bottom: 32px; padding: 28px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 16px; position: relative; }
        .hero-compact::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--page-primary), var(--page-light), var(--yellow)); }
        .hero-tag { display: inline-flex; background: var(--page-glow); border: 1px solid var(--page-primary); padding: 5px 14px; border-radius: 9999px; font-size: 12px; color: var(--page-light); margin-bottom: 12px; width: fit-content; }
        .hero-left h1 { font-size: 28px; margin-bottom: 8px; }
        .hero-left p { font-size: 13px; color: var(--text-secondary); line-height: 1.6; }
        .hero-metrics { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .hero-metric { background: var(--bg-card-alt); border: 1px solid var(--border-color); border-radius: 12px; padding: 16px; text-align: center; position: relative; }
        .hero-metric::before { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px; background: var(--page-primary); border-radius: 0 0 12px 12px; }
        .hero-metric-value { font-size: 24px; font-weight: 700; color: var(--page-light); }
        .hero-metric-label { font-size: 10px; color: var(--text-muted); margin-top: 4px; }
        
        .module { margin-bottom: 32px; padding-top: 24px; border-top: 1px solid var(--border-color); }
        .module:first-of-type { border-top: none; padding-top: 0; }
        .module-header { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; }
        .module-icon { width: 52px; height: 52px; background: var(--page-glow); border: 2px solid var(--page-primary); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 26px; }
        .module-info h2 { font-size: 20px; margin-bottom: 4px; }
        .module-info p { font-size: 12px; color: var(--text-muted); }
        
        .overview-content { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
        .overview-content h3 { font-size: 16px; margin-bottom: 12px; color: var(--page-light); }
        .overview-content p { font-size: 13px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 12px; }
        .overview-content p:last-child { margin-bottom: 0; }
        
        .viz-container { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 16px; overflow: hidden; margin-bottom: 20px; }
        .viz-header { padding: 12px 20px; background: var(--bg-card-alt); border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .viz-title { font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .viz-badge { font-size: 11px; padding: 4px 12px; border-radius: 9999px; background: var(--page-glow); color: var(--page-light); }
        .viz-canvas { padding: 20px; background: var(--bg-dark); }
        
        .api-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 20px; }
        .api-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; text-align: center; position: relative; overflow: hidden; }
        .api-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
        .api-card.sql::before { background: var(--blue); }
        .api-card.streaming::before { background: var(--green); }
        .api-card.mllib::before { background: var(--violet); }
        .api-card.graphx::before { background: var(--pink); }
        .api-icon { font-size: 32px; margin-bottom: 12px; }
        .api-title { font-size: 14px; font-weight: 600; margin-bottom: 6px; }
        .api-desc { font-size: 10px; color: var(--text-secondary); line-height: 1.5; }
        
        .feature-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 20px; }
        .feature-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; }
        .feature-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid var(--border-color); }
        .feature-icon { width: 44px; height: 44px; background: var(--page-glow); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .feature-title { font-size: 15px; font-weight: 600; }
        .feature-subtitle { font-size: 10px; color: var(--text-muted); }
        .feature-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.6; margin-bottom: 12px; }
        .feature-list { list-style: none; }
        .feature-list li { font-size: 10px; padding: 4px 0; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }
        .feature-list li::before { content: '‚úì'; color: var(--green); }
        
        .comparison-table { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
        .comparison-header { background: var(--bg-card-alt); padding: 12px 16px; border-bottom: 1px solid var(--border-color); }
        .comparison-title { font-size: 13px; font-weight: 600; }
        .comparison-table table { width: 100%; border-collapse: collapse; }
        .comparison-table th { background: var(--bg-card-alt); padding: 10px 12px; text-align: left; font-size: 10px; font-weight: 600; color: var(--text-muted); border-bottom: 1px solid var(--border-color); }
        .comparison-table td { padding: 12px; font-size: 11px; border-bottom: 1px solid var(--border-color); vertical-align: middle; }
        .comparison-table tr:hover td { background: var(--bg-hover); }
        
        .code-example { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; margin-bottom: 20px; }
        .code-example-header { padding: 12px 16px; background: var(--bg-card-alt); border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; }
        .code-example-title { font-size: 12px; font-weight: 600; }
        .code-example-file { font-size: 10px; color: var(--text-muted); font-family: monospace; }
        .code-example-content { padding: 16px; font-family: 'Monaco', 'Consolas', monospace; font-size: 11px; line-height: 1.7; background: var(--bg-dark); overflow-x: auto; }
        .code-comment { color: #6A737D; }
        .code-keyword { color: #FF7B72; }
        .code-string { color: #A5D6FF; }
        .code-function { color: #D2A8FF; }
        
        .deploy-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 20px; }
        .deploy-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; }
        .deploy-header { padding: 16px; background: linear-gradient(135deg, rgba(226,90,28,0.2), transparent); border-bottom: 1px solid var(--border-color); }
        .deploy-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; }
        .deploy-subtitle { font-size: 10px; color: var(--text-muted); }
        .deploy-body { padding: 16px; }
        .deploy-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.5; margin-bottom: 12px; }
        .deploy-features { list-style: none; }
        .deploy-features li { font-size: 10px; padding: 4px 0; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }
        .deploy-features li::before { content: '‚Üí'; color: var(--page-light); }
        
        .best-practices { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 20px; }
        .practice-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; }
        .practice-card.do { border-left: 3px solid var(--green); }
        .practice-card.dont { border-left: 3px solid var(--red); }
        .practice-title { font-size: 14px; font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .practice-title.do { color: var(--green); }
        .practice-title.dont { color: var(--red); }
        .practice-list { list-style: none; }
        .practice-list li { font-size: 11px; color: var(--text-secondary); padding: 6px 0; border-bottom: 1px solid var(--border-color); display: flex; align-items: flex-start; gap: 8px; }
        .practice-list li:last-child { border-bottom: none; }
        .practice-list li::before { content: '‚úì'; color: var(--green); flex-shrink: 0; }
        .practice-card.dont .practice-list li::before { content: '‚úó'; color: var(--red); }
        
        .agent-grid { display: grid; grid-template-columns: 1fr 1.5fr; gap: 20px; }
        .agent-info { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; padding: 20px; }
        .agent-avatar { width: 56px; height: 56px; background: linear-gradient(135deg, var(--page-primary), var(--page-light)); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 28px; margin-bottom: 16px; }
        .agent-name { font-size: 18px; font-weight: 600; margin-bottom: 4px; }
        .agent-role { font-size: 11px; color: var(--page-light); margin-bottom: 16px; }
        .agent-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 16px; }
        .agent-capabilities { list-style: none; }
        .agent-capabilities li { font-size: 11px; color: var(--text-secondary); padding: 6px 0; display: flex; align-items: center; gap: 8px; }
        .agent-capabilities li::before { content: '‚ú¶'; color: var(--page-light); }
        
        .code-panel { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 12px; overflow: hidden; }
        .code-header { display: flex; align-items: center; background: var(--bg-card-alt); border-bottom: 1px solid var(--border-color); }
        .code-tab { padding: 12px 20px; font-size: 12px; color: var(--text-muted); cursor: pointer; border-bottom: 2px solid transparent; }
        .code-tab.active { color: var(--page-light); border-bottom-color: var(--page-light); background: rgba(226,90,28,0.1); }
        .code-filename { margin-left: auto; padding: 12px 20px; font-size: 11px; color: var(--text-muted); font-family: monospace; }
        .code-content { padding: 16px; font-family: 'Monaco', 'Consolas', monospace; font-size: 11px; line-height: 1.8; background: var(--bg-dark); overflow-x: auto; }
        
        .related-pages { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .related-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 10px; padding: 16px; text-decoration: none; color: inherit; transition: all 0.2s; }
        .related-card:hover { border-color: var(--page-primary); transform: translateY(-2px); }
        .related-num { font-size: 10px; color: var(--page-light); margin-bottom: 4px; }
        .related-title { font-size: 12px; font-weight: 600; margin-bottom: 4px; }
        .related-desc { font-size: 10px; color: var(--text-muted); }
        
        footer { background: var(--bg-card); border-top: 1px solid var(--border-color); padding: 20px 32px; margin-left: var(--sidebar-width); }
        .footer-nav { display: flex; justify-content: space-between; align-items: center; }
        .footer-link { display: flex; align-items: center; gap: 12px; text-decoration: none; color: var(--text-secondary); padding: 12px 20px; background: var(--bg-card-alt); border: 1px solid var(--border-color); border-radius: 10px; transition: all 0.2s; }
        .footer-link:hover { border-color: var(--page-primary); color: var(--text-primary); }
        .footer-link-label { font-size: 10px; color: var(--text-muted); }
        .footer-link-title { font-size: 13px; font-weight: 600; }
        .footer-brand { font-size: 12px; color: var(--text-muted); }
        .footer-brand strong { color: var(--brand-orange); }
        
        @media (max-width: 1024px) {
            .sidebar { display: none; }
            .main-wrapper { margin-left: 0; }
            footer { margin-left: 0; }
            .hero-compact, .best-practices, .agent-grid, .feature-grid { grid-template-columns: 1fr; }
            .api-grid { grid-template-columns: repeat(2, 1fr); }
            .deploy-grid, .related-pages { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>

<header>
    <div class="logo"><span>STRATEGY</span>HUB</div>
    <div class="header-tagline">Enterprise Technology Knowledge Base</div>
</header>

<aside class="sidebar">
    <div class="sidebar-section">
        <div class="sidebar-title">üîß Category 02</div>
        <ul class="sidebar-nav">
            <li><a href="cat02-data-engineering-overview.html"><span class="nav-icon">üè†</span> Overview</a></li>
        </ul>
    </div>
    <div class="sidebar-section">
        <div class="sidebar-title">üìÑ This Page</div>
        <ul class="sidebar-nav">
            <li><a href="#overview" class="active"><span class="nav-icon">üìñ</span> Overview</a></li>
            <li><a href="#architecture"><span class="nav-icon">üèóÔ∏è</span> Architecture</a></li>
            <li><a href="#apis"><span class="nav-icon">üìö</span> Spark APIs</a></li>
            <li><a href="#dataframes"><span class="nav-icon">üìä</span> DataFrames</a></li>
            <li><a href="#deployment"><span class="nav-icon">‚òÅÔ∏è</span> Deployment</a></li>
            <li><a href="#practices"><span class="nav-icon">‚úÖ</span> Best Practices</a></li>
            <li><a href="#agent"><span class="nav-icon">ü§ñ</span> Agent This</a></li>
        </ul>
    </div>
    <div class="sidebar-section">
        <div class="sidebar-title">üìÑ Other Pages</div>
        <ul class="sidebar-nav">
            <li><a href="cat02-p1-data-ingestion.html"><span class="nav-icon">üì•</span> Data Ingestion</a></li>
            <li><a href="cat02-p2-data-transformation.html"><span class="nav-icon">üîÑ</span> Data Transformation</a></li>
            <li><a href="cat02-p3-databricks.html"><span class="nav-icon">üß±</span> Databricks</a></li>
            <li><a href="cat02-p4-snowflake.html"><span class="nav-icon">‚ùÑÔ∏è</span> Snowflake</a></li>
            <li><a href="cat02-p5-bigquery.html"><span class="nav-icon">üîç</span> BigQuery</a></li>
            <li><a href="cat02-p6-apache-spark.html" class="active"><span class="nav-icon">‚ö°</span> Apache Spark</a></li>
            <li><a href="cat02-p7-orchestration.html"><span class="nav-icon">üéº</span> Orchestration</a></li>
            <li><a href="cat02-p8-data-quality.html"><span class="nav-icon">‚úÖ</span> Data Quality</a></li>
            <li><a href="cat02-p9-observability.html"><span class="nav-icon">üëÅÔ∏è</span> Observability</a></li>
            <li><a href="cat02-p10-data-catalogs.html"><span class="nav-icon">üìö</span> Data Catalogs</a></li>
            <li><a href="cat02-p11-streaming.html"><span class="nav-icon">üåä</span> Streaming</a></li>
            <li><a href="cat02-p12-reverse-etl.html"><span class="nav-icon">‚Ü©Ô∏è</span> Reverse ETL</a></li>
        </ul>
    </div>
</aside>

<div class="main-wrapper">
    <div class="main-content">
        
        <!-- HERO -->
        <section class="hero-compact" id="overview">
            <div class="hero-left">
                <span class="hero-tag">‚ö° Page 2.6</span>
                <h1>Apache Spark</h1>
                <p>Master the unified analytics engine for large-scale data processing. Learn Spark's distributed architecture, DataFrames API, Spark SQL, Structured Streaming, and MLlib for machine learning at scale.</p>
            </div>
            <div class="hero-metrics">
                <div class="hero-metric"><div class="hero-metric-value">100x</div><div class="hero-metric-label">Faster than MapReduce</div></div>
                <div class="hero-metric"><div class="hero-metric-value">80%</div><div class="hero-metric-label">Big Data Market Share</div></div>
                <div class="hero-metric"><div class="hero-metric-value">Python</div><div class="hero-metric-label">Most Popular API</div></div>
                <div class="hero-metric"><div class="hero-metric-value">Open</div><div class="hero-metric-label">Source (Apache 2.0)</div></div>
            </div>
        </section>

        <!-- OVERVIEW -->
        <section class="module">
            <div class="module-header">
                <div class="module-icon">üìñ</div>
                <div class="module-info">
                    <h2>What is Apache Spark?</h2>
                    <p>The engine behind modern data platforms</p>
                </div>
            </div>
            
            <div class="overview-content">
                <h3>Unified Analytics Engine</h3>
                <p>Apache Spark is an open-source, distributed computing system designed for fast, general-purpose data processing. It provides high-level APIs in Python (PySpark), Scala, Java, and R, along with an optimized engine that supports general execution graphs. Spark powers batch processing, streaming, machine learning, and graph processing‚Äîall with a single, unified engine.</p>
                
                <h3>From MapReduce to Spark</h3>
                <p>Spark was created at UC Berkeley in 2009 to address the limitations of Hadoop MapReduce. While MapReduce required writing data to disk after each operation, Spark keeps data in memory (when possible), enabling iterative algorithms to run up to 100x faster. Spark became an Apache project in 2013 and has since become the de facto standard for big data processing.</p>
                
                <h3>The Engine Behind Everything</h3>
                <p>Today, Spark powers Databricks, runs on Amazon EMR, Google Dataproc, and Azure HDInsight, and is the compute engine for Delta Lake, Iceberg, and Hudi. Understanding Spark is essential for any data engineer working at scale‚Äîit's the foundation on which modern data platforms are built.</p>
            </div>
        </section>

        <!-- ARCHITECTURE -->
        <section class="module" id="architecture">
            <div class="module-header">
                <div class="module-icon">üèóÔ∏è</div>
                <div class="module-info">
                    <h2>Spark Architecture</h2>
                    <p>Driver, executors, and distributed execution</p>
                </div>
            </div>
            
            <div class="viz-container">
                <div class="viz-header">
                    <div class="viz-title">üìä Spark Cluster Architecture</div>
                    <div class="viz-badge">Distributed Processing</div>
                </div>
                <div class="viz-canvas">
                    <svg viewBox="0 0 900 320" style="width: 100%; height: auto;">
                        <!-- Driver Node -->
                        <g transform="translate(50, 30)">
                            <rect x="0" y="0" width="200" height="120" rx="12" fill="#E25A1C15" stroke="#E25A1C" stroke-width="2"/>
                            <text x="100" y="25" text-anchor="middle" fill="#FF7A45" font-size="12" font-weight="600">DRIVER PROGRAM</text>
                            
                            <rect x="20" y="40" width="160" height="30" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="100" y="60" text-anchor="middle" fill="#fff" font-size="10">SparkContext</text>
                            
                            <rect x="20" y="80" width="70" height="30" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="55" y="100" text-anchor="middle" fill="#6a6a7a" font-size="9">DAG Scheduler</text>
                            
                            <rect x="110" y="80" width="70" height="30" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="145" y="100" text-anchor="middle" fill="#6a6a7a" font-size="9">Task Scheduler</text>
                        </g>
                        
                        <!-- Cluster Manager -->
                        <g transform="translate(350, 50)">
                            <rect x="0" y="0" width="180" height="80" rx="12" fill="#8B5CF615" stroke="#8B5CF6" stroke-width="2"/>
                            <text x="90" y="25" text-anchor="middle" fill="#A78BFA" font-size="12" font-weight="600">CLUSTER MANAGER</text>
                            <text x="90" y="50" text-anchor="middle" fill="#fff" font-size="10">YARN / Kubernetes</text>
                            <text x="90" y="68" text-anchor="middle" fill="#6a6a7a" font-size="9">Standalone / Mesos</text>
                        </g>
                        
                        <!-- Worker Nodes -->
                        <g transform="translate(600, 20)">
                            <text x="125" y="0" text-anchor="middle" fill="#34D399" font-size="11" font-weight="600">WORKER NODES</text>
                            
                            <!-- Worker 1 -->
                            <rect x="0" y="15" width="250" height="80" rx="8" fill="#10B98115" stroke="#10B981" stroke-width="2"/>
                            <text x="125" y="35" text-anchor="middle" fill="#10B981" font-size="10" font-weight="600">Executor 1</text>
                            <rect x="15" y="45" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="47" y="62" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="47" y="76" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            <rect x="92" y="45" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="124" y="62" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="124" y="76" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            <rect x="170" y="45" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="202" y="62" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="202" y="76" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            
                            <!-- Worker 2 -->
                            <rect x="0" y="105" width="250" height="80" rx="8" fill="#10B98115" stroke="#10B981" stroke-width="2"/>
                            <text x="125" y="125" text-anchor="middle" fill="#10B981" font-size="10" font-weight="600">Executor 2</text>
                            <rect x="15" y="135" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="47" y="152" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="47" y="166" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            <rect x="92" y="135" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="124" y="152" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="124" y="166" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            <rect x="170" y="135" width="65" height="40" rx="4" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="202" y="152" text-anchor="middle" fill="#fff" font-size="8">Task</text>
                            <text x="202" y="166" text-anchor="middle" fill="#6a6a7a" font-size="7">Cache</text>
                            
                            <!-- Worker N -->
                            <rect x="0" y="195" width="250" height="80" rx="8" fill="#10B98115" stroke="#10B981" stroke-width="2" stroke-dasharray="4"/>
                            <text x="125" y="240" text-anchor="middle" fill="#10B981" font-size="10">Executor N...</text>
                        </g>
                        
                        <!-- Arrows -->
                        <defs>
                            <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <path d="M0,0 L0,6 L9,3 z" fill="#FF7A45"/>
                            </marker>
                        </defs>
                        <path d="M 250 90 L 350 90" stroke="#FF7A45" stroke-width="2" marker-end="url(#arrowOrange)"/>
                        <path d="M 530 90 L 600 70" stroke="#FF7A45" stroke-width="2" marker-end="url(#arrowOrange)"/>
                        <path d="M 530 90 L 600 160" stroke="#FF7A45" stroke-width="2" marker-end="url(#arrowOrange)"/>
                        
                        <!-- Legend -->
                        <g transform="translate(50, 280)">
                            <rect x="0" y="0" width="500" height="30" rx="6" fill="#1a1a2e" stroke="#2a2a3e"/>
                            <text x="20" y="20" fill="#6a6a7a" font-size="9">üìù Driver: Runs main(), creates SparkContext, coordinates work</text>
                            <text x="280" y="20" fill="#6a6a7a" font-size="9">‚öôÔ∏è Executors: Run tasks, cache data, report status</text>
                        </g>
                    </svg>
                </div>
            </div>
        </section>

        <!-- SPARK APIS -->
        <section class="module" id="apis">
            <div class="module-header">
                <div class="module-icon">üìö</div>
                <div class="module-info">
                    <h2>Spark APIs</h2>
                    <p>Unified libraries for every workload</p>
                </div>
            </div>
            
            <div class="api-grid">
                <div class="api-card sql">
                    <div class="api-icon">üìä</div>
                    <div class="api-title">Spark SQL</div>
                    <div class="api-desc">Query structured data with SQL. DataFrames and Datasets for type-safe processing.</div>
                </div>
                <div class="api-card streaming">
                    <div class="api-icon">üåä</div>
                    <div class="api-title">Structured Streaming</div>
                    <div class="api-desc">Real-time stream processing using the same DataFrame API as batch.</div>
                </div>
                <div class="api-card mllib">
                    <div class="api-icon">ü§ñ</div>
                    <div class="api-title">MLlib</div>
                    <div class="api-desc">Scalable machine learning: classification, regression, clustering, and more.</div>
                </div>
                <div class="api-card graphx">
                    <div class="api-icon">üï∏Ô∏è</div>
                    <div class="api-title">GraphX</div>
                    <div class="api-desc">Graph processing and analytics. PageRank, connected components, etc.</div>
                </div>
            </div>
            
            <div class="comparison-table">
                <div class="comparison-header">
                    <div class="comparison-title">RDD vs DataFrame vs Dataset</div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>RDD (Resilient Distributed Dataset)</th>
                            <th>DataFrame</th>
                            <th>Dataset (Scala/Java)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Abstraction</strong></td>
                            <td>Low-level, functional transformations</td>
                            <td>Table-like, columnar</td>
                            <td>Type-safe DataFrame</td>
                        </tr>
                        <tr>
                            <td><strong>Optimization</strong></td>
                            <td>None (manual)</td>
                            <td>Catalyst optimizer</td>
                            <td>Catalyst optimizer</td>
                        </tr>
                        <tr>
                            <td><strong>Type Safety</strong></td>
                            <td>Compile-time</td>
                            <td>Runtime only</td>
                            <td>Compile-time</td>
                        </tr>
                        <tr>
                            <td><strong>Use Case</strong></td>
                            <td>Unstructured data, fine control</td>
                            <td>Structured/semi-structured</td>
                            <td>Type-safe applications</td>
                        </tr>
                        <tr>
                            <td><strong>Recommendation</strong></td>
                            <td>Avoid (legacy)</td>
                            <td>‚úÖ Default choice</td>
                            <td>When type safety needed</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- DATAFRAMES -->
        <section class="module" id="dataframes">
            <div class="module-header">
                <div class="module-icon">üìä</div>
                <div class="module-info">
                    <h2>DataFrames & Spark SQL</h2>
                    <p>The modern way to use Spark</p>
                </div>
            </div>
            
            <div class="code-example">
                <div class="code-example-header">
                    <div class="code-example-title">PySpark DataFrame Operations</div>
                    <div class="code-example-file">PySpark</div>
                </div>
                <div class="code-example-content">
                    <pre><span class="code-keyword">from</span> pyspark.sql <span class="code-keyword">import</span> SparkSession
<span class="code-keyword">from</span> pyspark.sql.functions <span class="code-keyword">import</span> col, sum, avg, count, when

<span class="code-comment"># Create SparkSession</span>
spark = SparkSession.builder \
    .appName(<span class="code-string">"DataFrameExample"</span>) \
    .getOrCreate()

<span class="code-comment"># Read data</span>
df = spark.read.parquet(<span class="code-string">"s3://bucket/orders/"</span>)

<span class="code-comment"># DataFrame transformations (lazy evaluation)</span>
result = df \
    .filter(col(<span class="code-string">"status"</span>) == <span class="code-string">"completed"</span>) \
    .withColumn(<span class="code-string">"is_high_value"</span>, when(col(<span class="code-string">"amount"</span>) > 1000, <span class="code-keyword">True</span>).otherwise(<span class="code-keyword">False</span>)) \
    .groupBy(<span class="code-string">"region"</span>, <span class="code-string">"is_high_value"</span>) \
    .agg(
        count(<span class="code-string">"*"</span>).alias(<span class="code-string">"order_count"</span>),
        sum(<span class="code-string">"amount"</span>).alias(<span class="code-string">"total_revenue"</span>),
        avg(<span class="code-string">"amount"</span>).alias(<span class="code-string">"avg_order_value"</span>)
    ) \
    .orderBy(col(<span class="code-string">"total_revenue"</span>).desc())

<span class="code-comment"># Write results</span>
result.write.mode(<span class="code-string">"overwrite"</span>).parquet(<span class="code-string">"s3://bucket/regional_summary/"</span>)

<span class="code-comment"># Or use Spark SQL</span>
df.createOrReplaceTempView(<span class="code-string">"orders"</span>)
sql_result = spark.sql(<span class="code-string">"""
    SELECT region, COUNT(*) as orders, SUM(amount) as revenue
    FROM orders
    WHERE status = 'completed'
    GROUP BY region
"""</span>)</pre>
                </div>
            </div>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-header">
                        <div class="feature-icon">üîÑ</div>
                        <div>
                            <div class="feature-title">Lazy Evaluation</div>
                            <div class="feature-subtitle">Transformations vs Actions</div>
                        </div>
                    </div>
                    <div class="feature-desc">Transformations (filter, select, groupBy) are lazy‚Äîthey build a DAG but don't execute. Actions (count, collect, write) trigger execution.</div>
                    <ul class="feature-list">
                        <li>Transformations: filter, select, join, groupBy</li>
                        <li>Actions: count, collect, show, write</li>
                        <li>Catalyst optimizer plans before execution</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <div class="feature-header">
                        <div class="feature-icon">üíæ</div>
                        <div>
                            <div class="feature-title">Caching & Persistence</div>
                            <div class="feature-subtitle">Keep data in memory</div>
                        </div>
                    </div>
                    <div class="feature-desc">Cache DataFrames that are reused multiple times. Choose storage level based on memory availability and fault tolerance needs.</div>
                    <ul class="feature-list">
                        <li>df.cache() ‚Äî MEMORY_AND_DISK</li>
                        <li>df.persist(StorageLevel.MEMORY_ONLY)</li>
                        <li>df.unpersist() to free memory</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- DEPLOYMENT -->
        <section class="module" id="deployment">
            <div class="module-header">
                <div class="module-icon">‚òÅÔ∏è</div>
                <div class="module-info">
                    <h2>Deployment Options</h2>
                    <p>Where to run Spark</p>
                </div>
            </div>
            
            <div class="deploy-grid">
                <div class="deploy-card">
                    <div class="deploy-header">
                        <div class="deploy-title">Databricks</div>
                        <div class="deploy-subtitle">Managed Spark</div>
                    </div>
                    <div class="deploy-body">
                        <div class="deploy-desc">Fully managed Spark with optimizations (Photon), notebooks, and integrated governance. Best developer experience.</div>
                        <ul class="deploy-features">
                            <li>Optimized Spark runtime</li>
                            <li>Interactive notebooks</li>
                            <li>Delta Lake integration</li>
                            <li>Unity Catalog governance</li>
                        </ul>
                    </div>
                </div>
                
                <div class="deploy-card">
                    <div class="deploy-header">
                        <div class="deploy-title">Amazon EMR</div>
                        <div class="deploy-subtitle">AWS Managed</div>
                    </div>
                    <div class="deploy-body">
                        <div class="deploy-desc">Run Spark on AWS with deep S3 integration. EMR Serverless for auto-scaling without managing clusters.</div>
                        <ul class="deploy-features">
                            <li>EC2 or EKS deployment</li>
                            <li>EMR Serverless option</li>
                            <li>S3 native integration</li>
                            <li>Glue Data Catalog</li>
                        </ul>
                    </div>
                </div>
                
                <div class="deploy-card">
                    <div class="deploy-header">
                        <div class="deploy-title">Google Dataproc</div>
                        <div class="deploy-subtitle">GCP Managed</div>
                    </div>
                    <div class="deploy-body">
                        <div class="deploy-desc">Run Spark on GCP with fast cluster startup and GCS integration. Dataproc Serverless for zero-ops.</div>
                        <ul class="deploy-features">
                            <li>90-second cluster startup</li>
                            <li>Dataproc Serverless</li>
                            <li>BigQuery connector</li>
                            <li>GCS native support</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- BEST PRACTICES -->
        <section class="module" id="practices">
            <div class="module-header">
                <div class="module-icon">‚úÖ</div>
                <div class="module-info">
                    <h2>Best Practices</h2>
                    <p>Guidelines for Spark success</p>
                </div>
            </div>
            
            <div class="best-practices">
                <div class="practice-card do">
                    <div class="practice-title do">‚úì Do's</div>
                    <ul class="practice-list">
                        <li>Use DataFrames/Spark SQL over RDDs for optimization</li>
                        <li>Partition data appropriately (128MB-1GB per partition)</li>
                        <li>Use broadcast joins for small tables (&lt;10MB)</li>
                        <li>Cache DataFrames that are reused multiple times</li>
                        <li>Use columnar formats (Parquet, ORC) for storage</li>
                        <li>Leverage predicate pushdown and partition pruning</li>
                        <li>Monitor Spark UI for skew and spill</li>
                        <li>Use adaptive query execution (AQE) in Spark 3.x</li>
                    </ul>
                </div>
                <div class="practice-card dont">
                    <div class="practice-title dont">‚úó Don'ts</div>
                    <ul class="practice-list">
                        <li>Don't collect() large datasets to the driver</li>
                        <li>Avoid UDFs when built-in functions exist (slower)</li>
                        <li>Never use groupByKey‚Äîuse reduceByKey or aggregations</li>
                        <li>Don't over-partition (too many small files)</li>
                        <li>Avoid cartesian joins (cross joins without conditions)</li>
                        <li>Don't cache everything‚Äîonly reused DataFrames</li>
                        <li>Never ignore data skew‚Äîit kills performance</li>
                        <li>Avoid nested data types when possible</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- AGENT THIS -->
        <section class="module" id="agent">
            <div class="module-header">
                <div class="module-icon">ü§ñ</div>
                <div class="module-info">
                    <h2>Agent This</h2>
                    <p>AI-powered assistant for Spark</p>
                </div>
            </div>
            
            <div class="agent-grid">
                <div class="agent-info">
                    <div class="agent-avatar">‚ö°</div>
                    <div class="agent-name">SparkAgent</div>
                    <div class="agent-role">Distributed Computing Specialist</div>
                    <div class="agent-desc">Expert in Apache Spark, distributed computing, and big data optimization. Specializes in query optimization, cluster tuning, data skew resolution, and migration from legacy big data systems.</div>
                    <ul class="agent-capabilities">
                        <li>Optimize Spark jobs for performance</li>
                        <li>Debug data skew and shuffle issues</li>
                        <li>Design partitioning strategies</li>
                        <li>Convert SQL to optimized DataFrames</li>
                        <li>Tune cluster configuration</li>
                        <li>Migrate from Hadoop MapReduce</li>
                    </ul>
                </div>
                
                <div class="code-panel">
                    <div class="code-header">
                        <div class="code-tab active">Agent Definition</div>
                        <div class="code-tab">Optimization Task</div>
                        <div class="code-filename">spark_agent.py</div>
                    </div>
                    <div class="code-content">
                        <pre><span class="code-comment"># spark_agent.py - Apache Spark Agent</span>
<span class="code-keyword">from</span> crewai <span class="code-keyword">import</span> Agent, Task, Crew

<span class="code-function">spark_agent</span> = Agent(
    role=<span class="code-string">"Spark Performance Engineer"</span>,
    goal=<span class="code-string">"Optimize Spark jobs for speed and cost"</span>,
    backstory=<span class="code-string">"""Expert in Apache Spark internals, 
    distributed computing, and performance tuning. 
    Deep knowledge of Catalyst optimizer, tungsten 
    execution, shuffle operations, and cluster 
    resource management."""</span>,
    tools=[
        SparkUIAnalyzer(),
        QueryPlanExplainer(),
        SkewDetector(),
        PartitionOptimizer(),
        ClusterTuner(),
    ]
)

<span class="code-function">optimization_task</span> = Task(
    description=<span class="code-string">"""
    1. Analyze Spark job execution plan
    2. Identify bottlenecks (skew, shuffle, spill)
    3. Recommend partitioning changes
    4. Optimize join strategies
    5. Tune executor/memory configuration
    6. Implement caching strategy
    7. Generate performance report
    """</span>,
    agent=spark_agent,
    expected_output=<span class="code-string">"Optimized Spark job configuration"</span>
)

<span class="code-comment"># Execute Spark optimization</span>
crew = Crew(agents=[spark_agent], tasks=[optimization_task])
result = crew.kickoff()</pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- RELATED PAGES -->
        <section class="module" id="related">
            <div class="module-header">
                <div class="module-icon">üîó</div>
                <div class="module-info">
                    <h2>Related Pages</h2>
                    <p>Continue learning with these related topics</p>
                </div>
            </div>
            
            <div class="related-pages">
                <a href="cat02-p3-databricks.html" class="related-card">
                    <div class="related-num">Page 2.3</div>
                    <div class="related-title">Databricks Platform</div>
                    <div class="related-desc">Managed Spark with optimizations</div>
                </a>
                <a href="cat02-p11-streaming.html" class="related-card">
                    <div class="related-num">Page 2.11</div>
                    <div class="related-title">Streaming Platforms</div>
                    <div class="related-desc">Spark Structured Streaming deep-dive</div>
                </a>
                <a href="cat02-p7-orchestration.html" class="related-card">
                    <div class="related-num">Page 2.7</div>
                    <div class="related-title">Orchestration</div>
                    <div class="related-desc">Schedule and manage Spark jobs</div>
                </a>
            </div>
        </section>

    </div>
</div>

<footer>
    <div class="footer-nav">
        <a href="cat02-p5-bigquery.html" class="footer-link">
            <span>‚Üê</span>
            <div>
                <div class="footer-link-label">Previous Page</div>
                <div class="footer-link-title">2.5: Google BigQuery</div>
            </div>
        </a>
        <div class="footer-brand"><strong>STRATEGY</strong>HUB ‚Ä¢ Page 2.6 of 12</div>
        <a href="cat02-p7-orchestration.html" class="footer-link">
            <div>
                <div class="footer-link-label">Next Page</div>
                <div class="footer-link-title">2.7: Orchestration Tools</div>
            </div>
            <span>‚Üí</span>
        </a>
    </div>
</footer>

</body>
</html>
